/**
 * ------------------------------------------------------------------------====
 * REORGANIZED MENU SYSTEM
 * ------------------------------------------------------------------------====
 *
 * Organizes dashboard menus into three categories:
 * 1. Average User - Daily operations and common tasks
 * 2. Sheet Manager - Data management, performance, integrity, automations
 * 3. Administrator - System admin, seed functions, health monitoring
 *
 * To use this menu instead of the default one:
 * - Rename the existing onOpen() function to onOpen_OLD()
 * - Rename this onOpen_Reorganized() function to onOpen()
 */

function onOpen_Reorganized() {
  const ui = SpreadsheetApp.getUi();

  // ------------ AVERAGE USER MENU ------------
  ui.createMenu("ğŸ‘¤ Dashboard")
    .addItem("ğŸ”„ Refresh All", "refreshCalculations")
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“Š Dashboards")
      .addItem("ğŸ¯ Unified Operations Monitor", "showUnifiedOperationsMonitor")
      .addItem("ğŸ“Š Main Dashboard", "goToDashboard")
      .addItem("âœ¨ Interactive Dashboard", "openInteractiveDashboard")
      .addItem("ğŸ”„ Refresh Interactive Dashboard", "rebuildInteractiveDashboard"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ” Search & Lookup")
      .addItem("ğŸ” Search Members", "showMemberSearch")
      .addItem("ğŸ” Quick Member Search", "quickMemberSearch"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“‹ Grievance Tools")
      .addItem("â• Start New Grievance", "showStartGrievanceDialog")
      .addItem("ğŸ”„ Grievance Float Toggle", "toggleGrievanceFloat")
      .addItem("ğŸ›ï¸ Float Control Panel", "showGrievanceFloatPanel")
      .addSeparator()
      .addItem("ğŸ“¨ View Message Trail", "showMessageTrail")
      .addItem("ğŸ”„ Refresh Admin Highlights", "refreshAdminMessageHighlights"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“ Google Drive")
      .addItem("ğŸ“ Setup Folder for Grievance", "setupDriveFolderForGrievance")
      .addItem("ğŸ“ Upload Files", "showFileUploadDialog")
      .addItem("ğŸ“‚ Show Grievance Files", "showGrievanceFiles"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“§ Communications")
      .addItem("ğŸ“§ Compose Email", "composeGrievanceEmail")
      .addItem("ğŸ“ Email Templates", "showEmailTemplateManager")
      .addSeparator()
      .addItem("ğŸ“ View Communications Log", "showGrievanceCommunications"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“Š Reports")
      .addItem("ğŸ“Š Custom Report Builder", "showCustomReportBuilder")
      .addSeparator()
      .addItem("ğŸ“„ Export Grievances to CSV", "exportGrievancesToCSV")
      .addItem("ğŸ“„ Export Members to CSV", "exportMembersToCSV"))
    .addSeparator()
    .addSubMenu(ui.createMenu("â™¿ Accessibility")
      .addItem("â™¿ ADHD Control Panel", "showADHDControlPanel")
      .addItem("ğŸ¨ Theme Manager", "showThemeManager")
      .addSeparator()
      .addItem("ğŸŒ™ Quick Toggle Dark Mode", "quickToggleDarkMode")
      .addItem("ğŸ¯ Activate Focus Mode", "activateFocusMode")
      .addItem("ğŸ¯ Deactivate Focus Mode", "deactivateFocusMode"))
    .addSeparator()
    .addSubMenu(ui.createMenu("â“ Help & Support")
      .addItem("ğŸ“š Getting Started Guide", "showGettingStartedGuide")
      .addItem("â“ Help", "showHelp")
      .addItem("âŒ¨ï¸ Keyboard Shortcuts", "showKeyboardShortcuts"))
    .addToUi();

  // ------------ SHEET MANAGER MENU ------------
  ui.createMenu("ğŸ“Š Sheet Manager")
    .addSubMenu(ui.createMenu("ğŸ’¾ Data Management")
      .addItem("ğŸ’¾ Backup & Recovery Manager", "showBackupManager")
      .addSeparator()
      .addItem("ğŸ’¾ Create Backup Now", "createBackup")
      .addItem("âœ… Enable Automated Backups", "setupAutomatedBackups")
      .addItem("ğŸ”• Disable Automated Backups", "disableAutomatedBackups")
      .addSeparator()
      .addItem("ğŸ“Š View Backup Log", "navigateToBackupLog"))
    .addSeparator()
    .addSubMenu(ui.createMenu("âš¡ Performance")
      .addItem("ğŸ—„ï¸ Cache Status Dashboard", "showCacheStatusDashboard")
      .addSeparator()
      .addItem("ğŸ”¥ Warm Up All Caches", "warmUpCaches")
      .addItem("ğŸ—‘ï¸ Clear All Caches", "invalidateAllCaches"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ”’ Data Integrity")
      .addItem("ğŸ“Š Data Quality Dashboard", "showDataQualityDashboard")
      .addItem("ğŸ” Check Referential Integrity", "checkReferentialIntegrity")
      .addSeparator()
      .addItem("ğŸ“ Create Change Log Sheet", "createChangeLogSheet")
      .addItem("ğŸ†” Generate Next Member ID", "showNextMemberID")
      .addItem("ğŸ†” Generate Next Grievance ID", "showNextGrievanceID"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ¤– Automations")
      .addItem("ğŸ“¬ Notification Settings", "showNotificationSettings")
      .addItem("ğŸ“Š Report Automation Settings", "showReportAutomationSettings")
      .addSeparator()
      .addItem("âœ… Enable Daily Deadline Notifications", "setupDailyDeadlineNotifications")
      .addItem("ğŸ”• Disable Deadline Notifications", "disableDailyDeadlineNotifications")
      .addSeparator()
      .addItem("âœ… Enable Monthly Reports", "setupMonthlyReports")
      .addItem("âœ… Enable Quarterly Reports", "setupQuarterlyReports")
      .addItem("ğŸ”• Disable All Reports", "disableAutomatedReports"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“ Google Drive Integration")
      .addItem("ğŸ“ Batch Create All Folders", "batchCreateGrievanceFolders")
      .addItem("ğŸ“ Setup Drive Folders", "setupDriveFolderForGrievance"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“… Calendar Integration")
      .addItem("ğŸ“… Sync Deadlines to Calendar", "syncDeadlinesToCalendar")
      .addItem("ğŸ‘€ View Upcoming Deadlines", "showUpcomingDeadlinesFromCalendar")
      .addSeparator()
      .addItem("ğŸ—‘ï¸ Clear All Calendar Events", "clearAllCalendarEvents"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“ˆ Analysis & Insights")
      .addItem("ğŸ”® Predictive Analytics Dashboard", "showPredictiveAnalyticsDashboard")
      .addItem("ğŸ“ˆ Generate Full Analysis", "performPredictiveAnalysis")
      .addItem("ğŸ”¬ Root Cause Analysis", "showRootCauseAnalysisDashboard"))
    .addSeparator()
    .addSubMenu(ui.createMenu("âš¡ Batch Operations")
      .addItem("âš¡ Show Batch Operations Menu", "showBatchOperationsMenu")
      .addSeparator()
      .addItem("ğŸ‘¤ Bulk Assign Steward", "batchAssignSteward")
      .addItem("ğŸ“Š Bulk Update Status", "batchUpdateStatus")
      .addItem("ğŸ“„ Bulk Export to PDF", "batchExportPDF")
      .addItem("ğŸ“§ Bulk Email Notifications", "batchEmailNotifications")
      .addItem("ğŸ“ Bulk Add Notes", "batchAddNotes"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ¤– Smart Assignment")
      .addItem("ğŸ¤– Auto-Assign Steward", "showAutoAssignDialog")
      .addItem("ğŸ“¦ Batch Auto-Assign", "batchAutoAssign")
      .addSeparator()
      .addItem("ğŸ‘¥ Steward Workload Dashboard", "showStewardWorkloadDashboard"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“š Knowledge Base")
      .addItem("ğŸ“š Search FAQ", "showFAQSearch")
      .addItem("â• Add New FAQ", "showFAQAdmin")
      .addSeparator()
      .addItem("ğŸ“ Create FAQ Database", "createFAQSheet"))
    .addToUi();

  // ------------ SETUP MENU ------------
  ui.createMenu("ğŸ”§ Setup")
    .addSubMenu(ui.createMenu("ğŸŒ± Seed Functions")
      .addSubMenu(ui.createMenu("ğŸ‘¥ Seed Members")
        .addItem("Seed Members - Toggle 1 (5,000)", "SEED_MEMBERS_TOGGLE_1")
        .addItem("Seed Members - Toggle 2 (5,000)", "SEED_MEMBERS_TOGGLE_2")
        .addItem("Seed Members - Toggle 3 (5,000)", "SEED_MEMBERS_TOGGLE_3")
        .addItem("Seed Members - Toggle 4 (5,000)", "SEED_MEMBERS_TOGGLE_4")
        .addSeparator()
        .addItem("Seed All 20k Members (Legacy)", "SEED_20K_MEMBERS"))
      .addSubMenu(ui.createMenu("ğŸ“‹ Seed Grievances")
        .addItem("Seed Grievances - Toggle 1 (2,500)", "SEED_GRIEVANCES_TOGGLE_1")
        .addItem("Seed Grievances - Toggle 2 (2,500)", "SEED_GRIEVANCES_TOGGLE_2")
        .addSeparator()
        .addItem("Seed All 5k Grievances (Legacy)", "SEED_5K_GRIEVANCES"))
      .addSeparator()
      .addItem("ğŸ“ Add Sample Feedback Entries", "addSampleFeedbackEntries")
      .addSeparator()
      .addItem("ğŸ—‘ï¸ Nuke All Seed Data", "nukeSeedData")
      .addItem("Clear All Data", "clearAllData"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“‹ Dropdown Configuration")
      .addItem("ğŸ“‹ Setup All Dropdowns", "setupAllDropdowns")
      .addItem("ğŸ“‹ Setup Member Directory Dropdowns", "setupMemberDirectoryDropdowns")
      .addItem("ğŸ“‹ Setup Grievance Log Dropdowns", "setupGrievanceLogDropdowns")
      .addItem("ğŸ”„ Refresh Steward Dropdowns", "refreshStewardDropdowns")
      .addSeparator()
      .addItem("ğŸ“ˆ Extend Validations (10k rows)", "extendValidationsForLargeDataset"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ¨ Dashboard Setup")
      .addItem("ğŸ¨ Setup Dashboard Enhancements", "SETUP_DASHBOARD_ENHANCEMENTS")
      .addItem("ğŸ“Š Populate Analytics Sheets", "populateAllAnalyticsSheets"))
    .addSeparator()
    .addItem("ğŸ—‘ï¸ Remove Emergency Contact Columns", "removeEmergencyContactColumns")
    .addItem("ğŸ“ Open Member Google Form", "openMemberGoogleForm")
    .addToUi();

  // ------------ ADMINISTRATOR MENU ------------
  ui.createMenu("âš™ï¸ Administrator")
    .addSubMenu(ui.createMenu("âš ï¸ System Health")
      .addItem("âš ï¸ Error Dashboard", "showErrorDashboard")
      .addItem("ğŸ¥ Run Health Check", "performSystemHealthCheck")
      .addSeparator()
      .addItem("ğŸ“Š View Error Trends", "createErrorTrendReport")
      .addItem("ğŸ§ª Test Error Logging", "testErrorLogging"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ”¬ Root Cause Analysis")
      .addItem("ğŸ”¬ Root Cause Analysis Dashboard", "showRootCauseAnalysisDashboard"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ”„ Workflow Management")
      .addItem("ğŸ”„ Workflow Visualizer", "showWorkflowVisualizer")
      .addItem("ğŸ”„ Change Workflow State", "changeWorkflowState")
      .addItem("ğŸ“Š View Current State", "showCurrentWorkflowState")
      .addSeparator()
      .addItem("ğŸ“¦ Batch Update State", "batchUpdateWorkflowState"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ‘ï¸ Column Toggles & View")
      .addItem("Toggle Level 2 Member Columns", "toggleLevel2Columns")
      .addItem("Show All Member Columns", "showAllMemberColumns")
      .addSeparator()
      .addItem("ğŸ“¨ Toggle Admin Message Columns", "toggleAdminMessageColumns")
      .addItem("Show All Grievance Columns", "showAllGrievanceColumns")
      .addItem("ğŸ”§ Setup Admin Message Columns", "setupAdminMessageColumns")
      .addItem("âš¡ Install Admin Message Trigger", "installAdminMessageTrigger")
      .addSeparator()
      .addItem("ğŸ”„ Refresh Grievance Formulas", "refreshGrievanceFormulas")
      .addItem("ğŸ”„ Refresh Dashboard Deadlines", "refreshDashboardDeadlines")
      .addItem("ğŸ§¹ Cleanup Extra Member Columns", "cleanupMemberDirectoryColumns")
      .addSeparator()
      .addItem("ğŸ‘ï¸ Hide Diagnostics Tab", "hideDiagnosticsTab")
      .addItem("Reorder Sheets Logically", "reorderSheetsLogically")
      .addItem("Hide Gridlines (Focus Mode)", "hideAllGridlines")
      .addItem("Show Gridlines", "showAllGridlines")
      .addItem("Setup ADHD Defaults", "setupADHDDefaults"))
    .addSeparator()
    .addSubMenu(ui.createMenu("â†©ï¸ History & Undo")
      .addItem("â†©ï¸ Undo/Redo History", "showUndoRedoPanel")
      .addItem("âŒ¨ï¸ Install Undo Shortcuts", "installUndoRedoShortcuts")
      .addSeparator()
      .addItem("â†©ï¸ Undo Last Action (Ctrl+Z)", "undoLastAction")
      .addItem("â†ªï¸ Redo Last Action (Ctrl+Y)", "redoLastAction")
      .addSeparator()
      .addItem("ğŸ—‘ï¸ Clear Undo History", "clearUndoHistory"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ“± Mobile & Viewing")
      .addItem("ğŸ“± Mobile Dashboard", "showMobileDashboard")
      .addItem("ğŸ“‹ Mobile Grievance List", "showMobileGrievanceList")
      .addSeparator()
      .addItem("ğŸ“„ Paginated Data Viewer", "showPaginatedViewer"))
    .addSeparator()
    .addSubMenu(ui.createMenu("ğŸ§ª Testing")
      .addItem("ğŸ§ª Test Deadline Notifications", "testDeadlineNotifications")
      .addItem("ğŸ§ª Test Monthly Report", "generateMonthlyReport")
      .addItem("ğŸ§ª Test Quarterly Report", "generateQuarterlyReport")
      .addSeparator()
      .addItem("ğŸ”§ Diagnose Setup", "DIAGNOSE_SETUP")
      .addItem("âš™ï¸ Shortcuts Configuration", "showKeyboardShortcutsConfig")
      .addItem("F1 Context Help", "showContextHelp"))
    .addToUi();
}
